@model Umbraco13.Models.TableData

<div id="funds-table-container" style="margin: 40px auto 0 auto; width: 70%; max-width: 100%;">
    @if (Model != null && Model.Cells != null && Model.Cells.Count > 0)
    {
        <div class="table-responsive">
            <table class="@Model.TableClass">
            <thead>
                @{
                    var firstRow = Model.Cells.FirstOrDefault();
                    if (firstRow != null && firstRow.Any(c => c.Type == Umbraco13.Models.TableCellType.Th))
                    {
                        <tr class="table-light">
                            @foreach (var cell in firstRow)
                            {
                                if (cell.Type == Umbraco13.Models.TableCellType.Th)
                                {
                                    <th class="@(cell.CssClass ?? "text-center")" scope="@(cell.Scope ?? "col")">@cell.Value</th>
                                }
                            }
                        </tr>
                    }
                }
            </thead>
            <tbody>
                @foreach (var row in Model.Cells)
                {
                    // Skip header row (rows with TH cells in first position)
                    if (row.FirstOrDefault()?.Type != Umbraco13.Models.TableCellType.Th)
                    {
                        <tr>
                            @foreach (var cell in row)
                            {
                                <td class="@(cell.CssClass ?? "text-center")">@cell.Value</td>
                            }
                        </tr>
                    }
                }
            </tbody>
            </table>
        </div>
    }
    else
    {
        <p>No funds data available.</p>
    }
</div>

<script>
    // Function to reload the funds table
    function reloadFundsTable() {
        fetch('/funds/update-table')
            .then(response => response.text())
            .then(html => {
                document.getElementById('funds-table-container').innerHTML = html;
            })
            .catch(error => console.error('Error reloading funds table:', error));
    }

    // Reload every 20 minutes (20 * 60 * 1000 ms)
    setInterval(reloadFundsTable, 20 * 60 * 1000);
</script>
